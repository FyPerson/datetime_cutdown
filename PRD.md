# 倒计时清单 - 产品需求文档（PRD）

## 1. 产品概述

### 1.1 产品定位
倒计时清单是一个基于Web的时间管理应用，旨在帮助用户追踪重要日期、节日和工作相关事件，提供精确的倒计时展示、农历日期信息和实时天气数据。

### 1.2 目标用户
- 需要追踪重要节日和纪念日的个人用户
- 关注工作时间的上班族
- 需要查看农历日期和传统黄历信息的用户
- 需要多城市天气信息的用户

### 1.3 核心价值
- **时间可视化**：通过进度条和倒计时直观展示时间流逝
- **传统文化**：提供农历日期、黄历、节气等传统文化信息
- **生活便利**：集成天气、生活指数等实用信息
- **工作辅助**：显示工作日倒计时、发薪日提醒等功能

---

## 2. 功能需求

### 2.1 时间进度展示

#### 2.1.1 今日进度
- **功能描述**：显示当天已过去的时间进度
- **数据展示**：
  - 已过时间：XX小时 XX分钟 XX秒
  - 进度百分比（0-100%）
  - 进度条可视化
- **更新频率**：每秒更新
- **优先级**：P0（核心功能）

#### 2.1.2 本周进度
- **功能描述**：显示当前周已过去的时间进度
- **数据展示**：
  - 已过时间：XX天 XX小时 XX分钟
  - 进度百分比（0-100%）
  - 进度条可视化
- **计算方法**：从本周一开始计算
- **更新频率**：每秒更新
- **优先级**：P0

#### 2.1.3 本月进度
- **功能描述**：显示当前月份已过去的时间进度
- **数据展示**：
  - 已过时间：XX天 XX小时 XX分钟
  - 进度百分比（0-100%）
  - 进度条可视化
- **计算方法**：从本月1日开始计算
- **更新频率**：每秒更新
- **优先级**：P0

#### 2.1.4 今年进度
- **功能描述**：显示当前年份已过去的时间进度
- **数据展示**：
  - 已过时间：XX天 XX小时 XX分钟
  - 进度百分比（0-100%）
  - 进度条可视化
- **计算方法**：从1月1日开始计算，支持闰年（365/366天）
- **更新频率**：每秒更新
- **优先级**：P0

### 2.2 节日倒计时

#### 2.2.1 公历节日
支持以下公历节日倒计时：
- **元旦**：1月1日
- **情人节**：2月14日
- **儿童节**：6月1日
- **劳动节**：5月1日
- **国庆节**：10月1日

**功能要求**：
- 显示距离下一个节日的倒计时（天、时、分）
- 显示节日日期
- 显示进度百分比（基于上一个节日到目标节日的总时长）
- 自动计算跨年情况

#### 2.2.2 农历节日
支持以下农历节日倒计时：
- **春节**：农历正月初一
- **元宵节**：农历正月十五
- **端午节**：农历五月初五
- **中秋节**：农历八月十五

**功能要求**：
- 使用lunar.js库进行农历转换
- 自动计算农历节日对应的公历日期
- 显示距离下一个节日的倒计时
- 显示节日日期（公历+农历）
- 显示进度百分比

#### 2.2.3 节气倒计时
- **清明节**：根据具体年份计算（基于太阳黄经）
- 支持其他重要节气倒计时（可选）

**优先级**：
- 春节、元旦：P0（核心节日）
- 其他节日：P1（重要功能）

### 2.3 工作相关倒计时

#### 2.3.1 下班倒计时
- **功能描述**：显示距离下班的时间
- **工作时间配置**：
  - 上班时间：8:30
  - 午休开始：12:00
  - 午休结束：13:30
  - 下班时间：17:00
- **状态显示**：
  - **未开始**：距离上班时间倒计时
  - **上午工作**：距离午休倒计时（进度：0-50%）
  - **午休中**：距离下午上班倒计时（进度：50%）
  - **下午工作**：距离下班倒计时（进度：50-100%）
  - **已下班**：显示"今日已下班，请好好休息"
  - **休息日**：显示"今天是周末，请好好休息"
- **调班支持**：支持自定义调班工作日和休息日配置
- **优先级**：P1

#### 2.3.2 发薪日倒计时
- **功能描述**：显示距离下一个发薪日的倒计时
- **默认发薪日**：每月15日
- **状态显示**：
  - 发薪日当天：显示"今日为发薪日"
  - 其他时间：显示距离发薪日倒计时
- **数据展示**：
  - 剩余天数、小时、分钟、秒
  - 进度百分比
  - 目标日期
- **优先级**：P1

### 2.4 特殊日期倒计时

#### 2.4.1 儿童节倒计时
- **功能描述**：显示距离下一个儿童节的倒计时
- **日期**：每年6月1日
- **优先级**：P2

#### 2.4.2 二月最后一天倒计时
- **功能描述**：显示距离下一个2月最后一天的倒计时
- **特殊处理**：支持闰年（2月29日）和平年（2月28日）
- **优先级**：P2

#### 2.4.3 农历二月最后一天倒计时
- **功能描述**：显示距离下一个农历二月最后一天的倒计时
- **特殊处理**：农历二月可能有29天或28天
- **优先级**：P2

### 2.5 日期时间显示

#### 2.5.1 公历日期显示
- **显示内容**：
  - 完整日期：YYYY年MM月DD日 星期X
  - 当前时间：HH:MM:SS
  - 当前周数：第X周
  - 星座信息：XX座
- **更新频率**：每秒更新
- **格式示例**：2025年01月15日星期三 14:30:25 | 第3周 | 摩羯座
- **优先级**：P0

#### 2.5.2 农历日期显示
- **显示内容**：
  - 农历年份（中文）：XXXX年
  - 农历月份：正月、二月等
  - 农历日期：初一、初二等
  - 天干地支：
    - 年份天干地支：如"甲子年"
    - 月份天干地支：如"甲子月"
    - 日期天干地支：如"甲子日"
  - 生肖：属XX
- **格式示例**：农历XXXX年 正月十五 甲子年 甲子月 甲子日 [属鼠]
- **数据来源**：lunar.js库
- **优先级**：P0

### 2.6 黄历功能

#### 2.6.1 宜事项
- **功能描述**：显示当天的宜做事项
- **数据来源**：lunar.js库的getDayYi()方法
- **显示位置**：页面左侧
- **数据格式**：列表形式展示
- **优先级**：P1

#### 2.6.2 忌事项
- **功能描述**：显示当天的忌做事项
- **数据来源**：lunar.js库的getDayJi()方法
- **显示位置**：页面右侧
- **数据格式**：列表形式展示
- **优先级**：P1

### 2.7 天气功能

#### 2.7.1 多城市天气展示
- **功能描述**：支持同时查看多个城市的天气信息
- **默认城市**：
  - 杭州
  - 婺源
  - 景德镇
  - 天津
  - 城市选择器（可自定义添加城市）
- **每个城市显示信息**：
  - 城市名称
  - 当前温度
  - 温度区间（最低-最高）
  - 天气状况文字描述
  - 天气图标
  - 湿度、风向、风速
  - 气压、能见度、体感温度
  - 降水量、云量
- **优先级**：P1

#### 2.7.2 15天天气预报
- **功能描述**：显示未来14天的天气预报（从次日开始）
- **数据来源**：和风天气API（weather/15d接口）
- **显示内容**：
  - 日期（月/日 星期X）
  - 温度区间（最低-最高）
  - 天气状况
- **展开方式**：默认全部展开显示
- **优先级**：P1

#### 2.7.3 天气指数
- **功能描述**：显示生活相关的天气指数
- **支持的指数类型**：
  - 穿衣指数（type=3）
  - 感冒指数（type=4）
  - 紫外线指数（type=5）
  - 运动指数（type=1）
  - 旅游指数（type=6）
  - 晾晒指数（type=14）
  - 洗车指数（type=2）
- **显示内容**：
  - 指数名称
  - 等级（1-5级）
  - 类别（如：适宜、较适宜、一般、不适宜等）
- **优先级排序**：按重要性智能选择前6个指数显示
- **优先级**：P1

#### 2.7.4 空气质量
- **功能描述**：显示实时空气质量信息
- **显示内容**：
  - AQI指数（优先显示中国标准cn-mee）
  - AQI等级（优秀/良好/轻度污染等）
  - 主要污染物信息（前3项）
    - 污染物名称
    - 浓度值
    - 浓度单位
- **数据来源**：和风天气API（airquality/v1/current接口）
- **优先级**：P1

#### 2.7.5 天文信息
- **功能描述**：显示日出日落、月升月落和月相信息
- **显示内容**：
  - **日出日落**：
    - 日出时间（HH:mm）
    - 日落时间（HH:mm）
  - **月升月落**：
    - 月升时间（HH:mm）
    - 月落时间（HH:mm）
  - **月相信息**：
    - 月相名称（如：上弦月、满月等）
    - 月相图标
    - 照明度百分比
- **数据来源**：
  - 日出日落：和风天气API（astronomy/sun接口）
  - 月相信息：和风天气API（astronomy/moon接口）
- **优先级**：P1

#### 2.7.6 城市搜索
- **功能描述**：支持搜索和添加任意城市
- **功能特性**：
  - 搜索框输入城市名称
  - 热门城市快速选择
  - 最近选择城市历史记录
  - API搜索结果展示
- **数据来源**：和风天气API（geo/v2/city/lookup接口）
- **历史记录**：保存最近10个选择的城市到localStorage
- **优先级**：P1

#### 2.7.7 天气数据刷新
- **功能描述**：手动刷新天气数据
- **触发方式**：
  - 点击刷新按钮
  - 键盘快捷键（F5或Ctrl+R）
- **加载状态**：显示加载动画和提示
- **错误处理**：API失败时显示"-"或使用模拟数据
- **优先级**：P1

### 2.8 界面功能

#### 2.8.1 主题切换
- **功能描述**：支持明暗主题切换
- **切换方式**：点击右上角主题切换按钮
- **主题类型**：
  - 深色主题（默认）
  - 浅色主题
- **持久化**：主题选择保存到localStorage
- **优先级**：P0

#### 2.8.2 响应式设计
- **功能描述**：适配不同屏幕尺寸
- **支持范围**：
  - 桌面端（1920px+）
  - 平板端（768px-1919px）
  - 移动端（<768px）
- **布局方式**：
  - 桌面端：三栏布局（宜事项 | 主内容 | 忌事项）
  - 移动端：单栏布局，侧边栏可折叠
- **优先级**：P0

#### 2.8.3 页面导航
- **功能描述**：提供页面间导航
- **导航项**：
  - 首页（index.html）
  - 天气页（weather.html）
- **导航方式**：顶部导航栏链接
- **优先级**：P0

### 2.9 进度条特效

#### 2.9.1 里程碑标记
- **功能描述**：在进度条上标记重要里程碑
- **里程碑位置**：25%、50%、75%、90%
- **动画效果**：到达里程碑时播放庆祝动画
- **优先级**：P2

#### 2.9.2 进度文字效果
- **功能描述**：进度接近完成时的特殊提示
- **触发条件**：进度超过95%
- **视觉效果**：文字高亮显示
- **优先级**：P2

---

## 3. 技术需求

### 3.1 前端技术栈
- **HTML5**：语义化标签，支持ARIA无障碍访问
- **CSS3**：现代CSS特性，CSS变量支持主题切换
- **JavaScript（ES6+）**：原生JavaScript，无框架依赖
- **外部库**：
  - Font Awesome 6.0.0：图标库
  - lunar.js：农历日期计算

### 3.2 API集成
- **和风天气API**：
  - 实时天气：weather/now
  - 15天预报：weather/15d
  - 城市搜索：geo/v2/city/lookup
  - 天气指数：indices/1d
  - 空气质量：airquality/v1/current
  - 日出日落：astronomy/sun
  - 月相信息：astronomy/moon

### 3.3 数据存储
- **localStorage**：主题选择、天气城市历史记录
- **内存存储**：实时计算的时间数据

### 3.4 性能要求
- **更新时间间隔**：1秒（1000ms）
- **动画帧率**：使用requestAnimationFrame优化动画
- **API请求**：
  - 并发请求多个城市数据
  - 请求延迟：2秒间隔
  - 最大重试次数：3次
  - 指数退避策略

### 3.5 兼容性要求
- **浏览器支持**：
  - Chrome（最新2个版本）
  - Firefox（最新2个版本）
  - Edge（最新2个版本）
  - Safari（最新2个版本）
- **特性要求**：
  - 支持ES6+
  - 支持CSS变量
  - 支持localStorage
  - 支持Fetch API

---

## 4. 非功能需求

### 4.1 可用性
- **加载时间**：首屏加载时间<3秒
- **响应速度**：用户操作响应时间<100ms
- **错误处理**：API失败时显示友好的错误提示，不阻塞其他功能

### 4.2 可访问性
- **ARIA标签**：关键元素添加适当的ARIA标签
- **键盘导航**：支持键盘操作（Tab、Enter、Esc等）
- **语义化HTML**：使用正确的HTML语义标签

### 4.3 可维护性
- **代码结构**：分层架构（数据计算层、数据处理层、渲染层）
- **代码注释**：关键函数和复杂逻辑添加注释
- **配置分离**：节日配置、工作时间配置等可配置化

### 4.4 可靠性
- **错误恢复**：API失败时使用默认数据或模拟数据
- **边界处理**：正确处理跨年、跨月、闰年等边界情况
- **数据验证**：对API返回数据进行验证和容错处理

---

## 5. 用户界面需求

### 5.1 布局设计
- **头部区域**：
  - 应用标题（带图标）
  - 导航按钮（天气链接、主题切换）
- **主内容区**：
  - 日期时间显示（公历+农历）
  - 进度卡片列表（按时间排序）
- **侧边栏**（桌面端）：
  - 左侧：宜事项列表
  - 右侧：忌事项列表

### 5.2 视觉设计
- **颜色方案**：
  - 深色主题：深色背景，浅色文字
  - 浅色主题：浅色背景，深色文字
- **字体**：系统默认字体，支持中英文
- **图标**：使用Font Awesome图标库
- **间距**：统一的边距和间距规范

### 5.3 交互设计
- **加载状态**：显示加载动画和提示文字
- **错误提示**：友好的错误消息显示
- **进度动画**：平滑的进度条更新动画
- **主题切换**：平滑的主题切换过渡效果

---

## 6. 数据需求

### 6.1 节日数据
- **公历节日**：固定日期，代码配置
- **农历节日**：基于lunar.js计算
- **调班配置**：支持按年份配置调班工作日和休息日

### 6.2 天气数据
- **实时数据**：从和风天气API获取
- **预报数据**：15天天气预报
- **数据更新**：手动刷新或按需更新

### 6.3 用户数据
- **主题偏好**：localStorage存储
- **城市历史**：localStorage存储，最多10条

---

## 7. 开发计划

### 7.1 功能优先级
- **P0（核心功能）**：
  - 时间进度展示（今日/本周/本月/今年）
  - 日期时间显示（公历+农历）
  - 主题切换
  - 节日倒计时（春节、元旦）

- **P1（重要功能）**：
  - 其他节日倒计时
  - 工作相关倒计时
  - 天气功能完整实现
  - 黄历功能

- **P2（可选功能）**：
  - 特殊日期倒计时
  - 进度条特效
  - 动画优化

### 7.2 开发阶段
1. **第一阶段**：核心时间展示功能（P0）
2. **第二阶段**：节日倒计时功能（P0+P1）
3. **第三阶段**：天气功能集成（P1）
4. **第四阶段**：界面优化和特效（P2）

---

## 8. 测试需求

### 8.1 功能测试
- 时间计算准确性测试
- 节日日期计算测试
- API数据获取和处理测试
- 主题切换功能测试

### 8.2 兼容性测试
- 不同浏览器测试
- 不同屏幕尺寸测试
- 移动端适配测试

### 8.3 性能测试
- 页面加载性能
- 动画流畅度
- API请求响应时间

### 8.4 边界测试
- 跨年、跨月边界情况
- API失败场景
- 网络异常情况

---

## 9. 部署需求

### 9.1 部署环境
- **开发环境**：本地HTTP服务器（Python/Node.js）
- **生产环境**：支持静态网站托管平台
  - GitHub Pages
  - Vercel
  - Netlify

### 9.2 依赖要求
- 无服务器端依赖
- 纯前端应用
- 需要外部API服务（和风天气）
- 需要CDN资源（Font Awesome）

---

## 10. 更新和维护

### 10.1 节日配置更新
- 每年需要更新调班配置
- 支持节假日动态配置

### 10.2 API维护
- 监控API状态
- 处理API变更和升级
- 备选API方案

### 10.3 功能迭代
- 根据用户反馈增加新节日
- 优化计算性能
- 增加新功能特性

---

## 11. 风险评估

### 11.1 技术风险
- **API依赖**：和风天气API可能变更或限制
  - **缓解措施**：实现模拟数据备选方案，API失败时显示"-"
  
- **农历计算**：依赖lunar.js库
  - **缓解措施**：使用稳定版本，必要时可替换实现

### 11.2 功能风险
- **时间计算准确性**：时区、夏令时等因素
  - **缓解措施**：基于用户本地时区计算

- **性能问题**：大量实时更新可能影响性能
  - **缓解措施**：优化更新频率，使用防抖和节流

---

## 12. 附录

### 12.1 术语表
- **PRD**：Product Requirements Document（产品需求文档）
- **P0/P1/P2**：优先级标识
- **AQI**：Air Quality Index（空气质量指数）
- **API**：Application Programming Interface（应用程序编程接口）

### 12.2 参考资料
- 和风天气API文档
- lunar.js库文档
- Font Awesome图标库文档

---

**文档版本**：v1.0  
**最后更新**：2025年1月  
**文档维护者**：开发团队

